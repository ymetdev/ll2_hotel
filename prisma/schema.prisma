generator client {
  provider     = "prisma-client"
  output       = "../src/generated/prisma"
  moduleFormat = "cjs"
}

datasource db {
  provider = "mysql"

}

model bookings {
  id          BigInt          @id @default(autoincrement()) @db.UnsignedBigInt
  user_id     BigInt          @db.UnsignedBigInt
  room_id     BigInt          @db.UnsignedBigInt
  check_in    DateTime        @db.Date
  check_out   DateTime        @db.Date
  total_price Decimal         @db.Decimal(10, 2)
  status      bookings_status @default(pending)
  created_at  DateTime?       @default(now()) @db.DateTime(0)
  updated_at  DateTime?       @default(now()) @db.DateTime(0)
  rooms       rooms           @relation(fields: [room_id], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "fk_booking_room")
  users       users           @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "fk_booking_user")

  @@index([user_id], map: "fk_booking_user")
  @@index([check_in, check_out], map: "idx_booking_dates")
  @@index([room_id], map: "idx_booking_room")
}

model room_images {
  id         BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  room_id    BigInt    @db.UnsignedBigInt
  image_url  String    @db.Text
  is_cover   Boolean?  @default(false)
  sort_order Int?      @default(0)
  created_at DateTime? @default(now()) @db.DateTime(0)
  rooms      rooms     @relation(fields: [room_id], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "fk_room_image")

  @@index([room_id], map: "idx_room_image_room")
}

model rooms {
  id              BigInt        @id @default(autoincrement()) @db.UnsignedBigInt
  name            String        @db.VarChar(255)
  description     String?       @db.Text
  price_per_night Decimal       @db.Decimal(10, 2)
  total_rooms     Int           @default(1)
  status          rooms_status  @default(active)
  created_at      DateTime?     @default(now()) @db.DateTime(0)
  updated_at      DateTime?     @default(now()) @db.DateTime(0)
  bookings        bookings[]
  room_images     room_images[]
}

model users {
  id         BigInt     @id @default(autoincrement()) @db.UnsignedBigInt
  name       String     @db.VarChar(255)
  email      String     @unique(map: "email") @db.VarChar(255)
  password   String     @db.VarChar(255)
  role       users_role @default(user)
  created_at DateTime?  @default(now()) @db.DateTime(0)
  updated_at DateTime?  @default(now()) @db.DateTime(0)
  bookings   bookings[]
}

enum users_role {
  user
  admin
}

enum rooms_status {
  active
  inactive
}

enum bookings_status {
  pending
  paid
  cancelled
}
